const consumer = require('../rd-kafka-consumer')
const producer = require('../rd-kafka-producer')

const Kafka = require('node-rdkafka')
let i = 0;

const onConsumerInit = (err) => {
    if (err) {
        console.error(err)
    } else {
        console.log('ready:');
    }
};

// consumer.init(onConsumerInit, null);

producer.init(onConsumerInit);

const foo = () => {
    producer.send('three', (i++).toString());
};

setInterval(foo, 1500);


// producer.send('three', 'a');
// producer.send('three', 'b');
// producer.send('three', 'c');
//
// let options = {
//     'client.id': 'asd',
//     'metadata.broker.list': 'localhost:9092',
//     'dr_cb': true
// };
//
// let topicOpts = {
//     'request.required.acks': -1,
//     'produce.offset.report': true
// };
//
// let producer = new Kafka.Producer(options, topicOpts);
//
// producer.connect();
//
//
// const onReady = () => {
//     try {
//         producer.produce(
//             //topic
//             'three',
//             //partition, default is -1
//             -1,
//             //message
//             new Buffer('1msg'),
//             //key
//             null,
//             //timestamp
//             Date.now(),
//             null
//         );
//         console.log('try:');
//
//     } catch (err) {
//         console.error('Error sending messages to Kafka: ', err);
//     }
// };
//
// producer
//     .on('ready', onReady)
//     // .on('event.error', onError)
//     .on('delivery-report', function (err, report) {
//         console.log(report);
//     });
//
// setInterval(() => { producer.poll() }, 3000)